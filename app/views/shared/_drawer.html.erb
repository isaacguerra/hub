<div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
  <div class="sidebar-header d-flex align-items-center justify-content-between p-3 bg-primary text-white">
    <h5 class="offcanvas-title fw-bold" id="sidebarMenuLabel">Menu Principal</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  
  <div class="offcanvas-body p-0">
    <nav class="sidebar-menu mt-3">
      <div class="nav flex-column">
        <%= link_to root_path, class: "nav-link #{'active' if current_page?(root_path)}" do %>
          <i class="bi bi-speedometer2"></i> Dashboard
        <% end %>

        <div class="text-uppercase text-muted small fw-bold px-4 mt-4 mb-2">Gestão</div>
        
        <%= link_to apoiadores_path, class: "nav-link #{'active' if controller_name == 'apoiadores'}" do %>
          <i class="bi bi-people"></i> Apoiadores
        <% end %>
        
        <%= link_to funcoes_path, class: "nav-link #{'active' if controller_name == 'funcoes'}" do %>
          <i class="bi bi-briefcase"></i> Funções
        <% end %>

        <div class="text-uppercase text-muted small fw-bold px-4 mt-4 mb-2">Campanha</div>

        <%= link_to eventos_path, class: "nav-link #{'active' if controller_name == 'eventos'}" do %>
          <i class="bi bi-calendar-event"></i> Eventos
        <% end %>
        
        <%= link_to visitas_path, class: "nav-link #{'active' if controller_name == 'visitas'}" do %>
          <i class="bi bi-calendar-check"></i> Visitas
        <% end %>
        
        <%= link_to convites_path, class: "nav-link #{'active' if controller_name == 'convites'}" do %>
          <i class="bi bi-envelope-paper"></i> Convites
        <% end %>
        
        <%= link_to comunicados_path, class: "nav-link #{'active' if controller_name == 'comunicados'}" do %>
          <i class="bi bi-megaphone"></i> Comunicados
        <% end %>

        <div class="text-uppercase text-muted small fw-bold px-4 mt-4 mb-2">Engajamento</div>

        <a href="#gamificationMenu" 
           class="nav-link d-flex justify-content-between align-items-center <%= 'collapsed' unless controller_path.start_with?('gamification/') %>" 
           data-bs-toggle="collapse" 
           role="button" 
           aria-expanded="<%= controller_path.start_with?('gamification/') %>" 
           aria-controls="gamificationMenu">
          <span><i class="bi bi-trophy"></i> Gamificação</span>
          <i class="bi bi-chevron-down small" style="font-size: 0.8em;"></i>
        </a>

        <div class="collapse <%= 'show' if controller_path.start_with?('gamification/') %>" id="gamificationMenu">
          <div class="nav flex-column ms-3 border-start border-2 ps-2">
            <%= link_to gamification_challenges_path, class: "nav-link #{'active' if controller_name == 'challenges'}" do %>
              <i class="bi bi-list-check"></i> Missões
            <% end %>
            
            <%= link_to gamification_configurations_path, class: "nav-link #{'active' if controller_name == 'configurations'}" do %>
              <i class="bi bi-gear"></i> Configurações
            <% end %>
          </div>
        </div>

        <div class="text-uppercase text-muted small fw-bold px-4 mt-4 mb-2">Configurações</div>

        <%= link_to municipios_path, class: "nav-link #{'active' if controller_name.in?(['municipios', 'regioes', 'bairros'])}" do %>
          <i class="bi bi-map"></i> Localidades
        <% end %>
      </div>
    </nav>
  </div>
  
  <div class="p-3 border-top bg-light">
    <div class="d-grid">
      <a href="#" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-question-circle me-1"></i> Ajuda e Suporte
      </a>
    </div>
  </div>
</div>
