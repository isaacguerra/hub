<%= form_with(model: visita, local: true, class: "needs-validation") do |form| %>
  <% if visita.errors.any? %>
    <div class="alert alert-danger">
      <h4 class="alert-heading">Erros encontrados:</h4>
      <ul class="mb-0">
        <% visita.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="card card-custom border-0 shadow-sm mb-4">
    <div class="card-body">
      <div class="mb-3">
        <%= form.label :apoiador_id, "Apoiador Visitado", class: "form-label fw-bold" %>
        <%= form.collection_select :apoiador_id, @apoiadores, :id, :nome, { prompt: "Selecione um apoiador" }, { class: "form-select", required: true } %>
      </div>

      <div class="mb-3">
        <%= form.label :status, "Status da Visita", class: "form-label fw-bold" %>
        <%= form.select :status, [['Pendente', 'pendente'], ['Concluída', 'concluida'], ['Cancelada', 'cancelada']], {}, { class: "form-select", required: true } %>
      </div>

      <div class="mb-3">
        <%= form.label :relato, "Relato da Visita", class: "form-label fw-bold" %>
        <%= form.text_area :relato, rows: 5, class: "form-control", placeholder: "Descreva como foi a visita, pontos discutidos e observações importantes...", required: true %>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-end gap-2">
    <%= link_to "Cancelar", visitas_path, class: "btn btn-outline-secondary" %>
    <%= form.submit "Salvar Visita", class: "btn btn-primary-custom text-white" %>
  </div>
<% end %>
